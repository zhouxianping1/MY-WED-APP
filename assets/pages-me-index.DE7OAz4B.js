import{$ as a,g as e,J as t,d as s,b as n,n as o,K as l,L as c,M as i,r as u,e as r,w as d,i as f,o as m,j as g,f as h,t as _,v as p,k as x,l as v,m as k}from"./index-D1azYyZI.js";import{C}from"./CustomNavBar.CZ4sq6xv.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=y({name:"MePage",components:{CustomNavBar:C},data:()=>({navBarHeight:64,userInfo:{nickname:"",avatar:"",role:"",openid:""},loading:!1,defaultAvatar:"/static/logo.png"}),onLoad(){this.getNavBarHeight(),this.loadUserInfo()},onShow(){this.loadUserInfo()},methods:{getNavBarHeight(){a("updateNavBarHeight",(a=>{this.navBarHeight=a}));try{const a=e("navBarHeight");a&&(this.navBarHeight=a)}catch(t){}},loadUserInfo(){try{const a=e("userInfo");a?this.userInfo=a:this.goToLogin()}catch(a){console.error("èŽ·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",a),this.goToLogin()}},getRoleText:a=>({admin:"ç³»ç»Ÿç®¡ç†å‘˜",operator:"ä»“åº“ç®¡ç†å‘˜",visitor:"è®¿å®¢ç”¨æˆ·"}[a]||"æœªçŸ¥è§’è‰²"),handleLanguageSetting(){t({itemList:["ç®€ä½“ä¸­æ–‡","Tiáº¿ng Viá»‡t"],success:a=>{const e=["zh","vi"][a.tapIndex];s("selectedLanguage",e),n({title:0===a.tapIndex?"å·²åˆ‡æ¢åˆ°ç®€ä½“ä¸­æ–‡":"ÄÃ£ chuyá»ƒn sang tiáº¿ng Viá»‡t",icon:"success"})}})},handleNotificationSetting(){n({title:"åŠŸèƒ½å¼€å‘ä¸­",icon:"none"})},handleSecuritySetting(){n({title:"åŠŸèƒ½å¼€å‘ä¸­",icon:"none"})},async handleDataExport(){"admin"===this.userInfo.role?t({itemList:["å¯¼å‡ºåŽŸæ–™æ•°æ®","å¯¼å‡ºå‡ºå…¥åº“è®°å½•","å¯¼å‡ºç”¨æˆ·æ•°æ®"],success:async a=>{this.loading=!0;try{switch(a.tapIndex){case 0:await this.exportMaterialData();break;case 1:await this.exportStockRecords();break;case 2:await this.exportUserData()}}catch(e){n({title:"å¯¼å‡ºå¤±è´¥",icon:"none"})}this.loading=!1}}):n({title:"ä»…ç®¡ç†å‘˜å¯å¯¼å‡ºæ•°æ®",icon:"none"})},async exportStockRecords(){try{const a=await o.callFunction({name:"stock-record",data:{action:"exportStockRecords",data:{}}});a.result&&0===a.result.code&&(n({title:"å¯¼å‡ºæˆåŠŸ",icon:"success"}),console.log("å¯¼å‡ºæ•°æ®:",a.result.data))}catch(a){throw console.error("å¯¼å‡ºå‡ºå…¥åº“è®°å½•å¤±è´¥:",a),a}},async exportMaterialData(){n({title:"åŽŸæ–™æ•°æ®å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­",icon:"none"})},async exportUserData(){n({title:"ç”¨æˆ·æ•°æ®å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­",icon:"none"})},handleAboutUs(){l({title:"å…³äºŽæˆ‘ä»¬",content:"æ³¨å¡‘å·¥åŽ‚åŽŸæ–™ä»“åº“ç®¡ç†ç³»ç»Ÿ\nç‰ˆæœ¬ï¼šv1.0.0\n\nä¸“ä¸šçš„åŽŸæ–™ä»“åº“ç®¡ç†è§£å†³æ–¹æ¡ˆ",showCancel:!1,confirmText:"ç¡®å®š"})},handleLogout(){l({title:"ç¡®è®¤é€€å‡º",content:"ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ",success:a=>{a.confirm&&(c("userInfo"),c("token"),this.goToLogin())}})},goToLogin(){i({url:"/pages/login/login"})}}},[["render",function(a,e,t,s,n,o){const l=u("custom-nav-bar"),c=x,i=f,C=v,y=k;return m(),r(i,{class:"me-container"},{default:d((()=>[g(l,{title:"ä¸ªäººä¸­å¿ƒ"}),g(i,{class:"page-content",style:p({paddingTop:n.navBarHeight+20+"px"})},{default:d((()=>[g(i,{class:"user-card"},{default:d((()=>[g(i,{class:"user-avatar"},{default:d((()=>[g(c,{src:n.userInfo.avatar||n.defaultAvatar,class:"avatar-image",mode:"aspectFill"},null,8,["src"])])),_:1}),g(i,{class:"user-info"},{default:d((()=>[g(C,{class:"user-name"},{default:d((()=>[h(_(n.userInfo.nickname||"æœªç™»å½•"),1)])),_:1}),g(C,{class:"user-role"},{default:d((()=>[h(_(o.getRoleText(n.userInfo.role)),1)])),_:1})])),_:1})])),_:1}),g(i,{class:"menu-list"},{default:d((()=>[g(i,{class:"menu-item",onClick:o.handleLanguageSetting},{default:d((()=>[g(i,{class:"menu-left"},{default:d((()=>[g(i,{class:"menu-icon language-icon"},{default:d((()=>[h("ðŸŒ")])),_:1}),g(C,{class:"menu-text"},{default:d((()=>[h("è¯­è¨€è®¾ç½®")])),_:1})])),_:1}),g(C,{class:"menu-arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"]),g(i,{class:"menu-item",onClick:o.handleNotificationSetting},{default:d((()=>[g(i,{class:"menu-left"},{default:d((()=>[g(i,{class:"menu-icon notification-icon"},{default:d((()=>[h("ðŸ””")])),_:1}),g(C,{class:"menu-text"},{default:d((()=>[h("é€šçŸ¥è®¾ç½®")])),_:1})])),_:1}),g(C,{class:"menu-arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"]),g(i,{class:"menu-item",onClick:o.handleSecuritySetting},{default:d((()=>[g(i,{class:"menu-left"},{default:d((()=>[g(i,{class:"menu-icon security-icon"},{default:d((()=>[h("ðŸ›¡ï¸")])),_:1}),g(C,{class:"menu-text"},{default:d((()=>[h("å®‰å…¨è®¾ç½®")])),_:1})])),_:1}),g(C,{class:"menu-arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"]),g(i,{class:"menu-item",onClick:o.handleDataExport},{default:d((()=>[g(i,{class:"menu-left"},{default:d((()=>[g(i,{class:"menu-icon export-icon"},{default:d((()=>[h("ðŸ“¤")])),_:1}),g(C,{class:"menu-text"},{default:d((()=>[h("æ•°æ®å¯¼å‡º")])),_:1})])),_:1}),g(C,{class:"menu-arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"]),g(i,{class:"menu-item",onClick:o.handleAboutUs},{default:d((()=>[g(i,{class:"menu-left"},{default:d((()=>[g(i,{class:"menu-icon about-icon"},{default:d((()=>[h("â„¹ï¸")])),_:1}),g(C,{class:"menu-text"},{default:d((()=>[h("å…³äºŽæˆ‘ä»¬")])),_:1})])),_:1}),g(C,{class:"menu-arrow"},{default:d((()=>[h(">")])),_:1})])),_:1},8,["onClick"])])),_:1}),g(i,{class:"logout-section"},{default:d((()=>[g(y,{class:"logout-btn",onClick:o.handleLogout},{default:d((()=>[h(" é€€å‡ºç™»å½• ")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-4fef91c8"]]);export{I as default};
